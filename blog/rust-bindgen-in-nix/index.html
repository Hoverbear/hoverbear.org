<!DOCTYPE html>
<html>
    <head>
        <!-- Fun compatability things -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
        <meta http-equiv="X-UA-Compatible" content="IE=edge">                  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <link rel="shortcut icon" href="https:&#x2F;&#x2F;hoverbear.org/images/favicon.ico">
    
        <!-- Information about this site -->
        <title>Using rust-bindgen in Nix
        </title>
        <meta name="description" content="A computer scientist working in open source towards a more hopeful future." />
    
        <!-- Various Twitter related content. -->
        <meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https:&#x2F;&#x2F;hoverbear.org&#x2F;processed_images&#x2F;2d932b616586a27500.jpg"/>
        <meta property='og:image' content="https:&#x2F;&#x2F;hoverbear.org&#x2F;processed_images&#x2F;2d932b616586a27500.jpg"/>
        <meta name="twitter:site" content="@a_hoverbear"/>
        <meta name="twitter:creator" content="@a_hoverbear"/>
        
        
            <meta name="twitter:title" content="Using rust-bindgen in Nix"/>
            <meta property='og:title' content="Using rust-bindgen in Nix"/>
        

        
            <meta property='og:url' content="https:&#x2F;&#x2F;hoverbear.org&#x2F;blog&#x2F;rust-bindgen-in-nix&#x2F;"/>
        

        
            <meta name="twitter:description" content="While building the Nix packages for pl&#x2F;Rust I bumped into a curious issue: I couldn&#x27;t link to stdio.h, or stdbool.h! They were clearly on my path, too.
It flummoxed me for quite some time, but exploring the firefox package led to a way forward. It was rust-bindgen not finding libraries!
"/>
            <meta property='og:description' content="While building the Nix packages for pl&#x2F;Rust I bumped into a curious issue: I couldn&#x27;t link to stdio.h, or stdbool.h! They were clearly on my path, too.
It flummoxed me for quite some time, but exploring the firefox package led to a way forward. It was rust-bindgen not finding libraries!
"/>
        
    
        <!-- Talk about the homepage and the rss feed. -->
        <link rel="canonical" href="https:&#x2F;&#x2F;hoverbear.org">
        <link rel="alternate" type="application/rss+xml" href="https:&#x2F;&#x2F;hoverbear.org/rss.xml">
    
        <!-- Stylesheets are fun -->
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Delius&family=Fira+Code&family=Noto+Sans&display=swap" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="screen" href="https:&#x2F;&#x2F;hoverbear.org/main.css" />
    
        <!-- Katex -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script>
        <!-- To automatically render math in text elements, include the auto-render extension: -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js" integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
    </head>
    

    <body>
        
    <div id="hero-wrapper">
    <figure class="enriched ">
        <figcaption>Photo&nbsp;- <a href="https://unsplash.com/photos/4XS-RtLwS_0">James Bruce</a></figcaption>
        <img srcset="
              https:&#x2F;&#x2F;hoverbear.org&#x2F;processed_images&#x2F;f75a3dbe11a3c9e100.jpg 1920w,
              https:&#x2F;&#x2F;hoverbear.org&#x2F;processed_images&#x2F;2d932b616586a27500.jpg 3840w
              "
              sizes="
                     (max-width: 1200px) 1200px,
                     (max-width: 1800px) 1800px,
                     3840px"
              src="https:&#x2F;&#x2F;hoverbear.org&#x2F;processed_images&#x2F;6392e1992f533f6e00.jpg"
              alt="Photo" />
    </figure>
</div>

    <header>
    <div class="content">
        <h1 id="main-title"><a id="main-link" href="https:&#x2F;&#x2F;hoverbear.org">
            Using rust-bindgen in Nix
        </a></h1>

        <nav id="tree"><ul><li>
            <a href="https://hoverbear.org/about/">
                Ana, Hoverbear üêª
            </a>&nbsp;
        </li><li>
            <a href="https://hoverbear.org/consulting/">
                Consulting Services
            </a>&nbsp;
        </li><li>
            <a href="https://hoverbear.org/blog/">
                Articles
            </a>&nbsp;
        </li></ul><ul></ul><ul></ul>
</nav>


        <div class="metadata">
            <p class="description">
                    Getting things linking.
                </p>

            <p class="date">
                    Posted on 2021-05-04, around 8 minutes of reading.
                </p>
        </div>
    </div>
</header>

    <main>
        
    <nav id=toc>
        <ol>
            
            <li>
                <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#why-rust-bindgen-fails">Why rust-bindgen fails</a>
                
                <ol>
                    
                    <li>
                        <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#missing-paths-from-gcc-wrapper">Missing paths from gcc-wrapper</a>
                    </li>
                    
                    <li>
                        <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#additional-paths">Additional paths</a>
                    </li>
                    
                </ol>
                
            </li>
            
            <li>
                <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#what-to-do-about-it">What to do about it</a>
                
            </li>
            
            <li>
                <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#worked-example">Worked Example</a>
                
                <ol>
                    
                    <li>
                        <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#files">Files</a>
                    </li>
                    
                    <li>
                        <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#working-output">Working output</a>
                    </li>
                    
                    <li>
                        <a href="https://hoverbear.org/blog/rust-bindgen-in-nix/#reproducing-the-issue">Reproducing the issue</a>
                    </li>
                    
                </ol>
                
            </li>
            
        </ol>
    </nav>

        <p>While building the Nix packages for <a href="https://github.com/zombodb/plrust">pl/Rust</a> I bumped into a curious issue: I couldn't link to <code>stdio.h</code>, or <code>stdbool.h</code>! They were clearly on my path, too.</p>
<p>It flummoxed me for quite some time, but exploring the <a href="https://github.com/NixOS/nixpkgs/blob/master/pkgs/applications/networking/browsers/firefox/common.nix#L247-L253"><code>firefox</code></a> package led to a way forward. It was <a href="https://github.com/rust-lang/rust-bindgen"><code>rust-bindgen</code></a> not finding libraries!</p>
<span id="continue-reading"></span><h1 id="why-rust-bindgen-fails">Why <code>rust-bindgen</code> fails</h1>
<p>In my case, there were multiple problems, but the problem solving of the first issue lead to me being able to handle the second much easier.</p>
<h2 id="missing-paths-from-gcc-wrapper">Missing paths from <code>gcc-wrapper</code></h2>
<p>Bindgen uses <a href="https://clang.llvm.org/doxygen/group__CINDEX.html"><code>libclang</code></a> instead of calling <code>$CC</code>. This means it interacts poorly which NixOS, whose <code>rustPlatform.buildRustPackage</code> sets a <code>$CC</code> for <code>rustc</code> to use.</p>
<p>You can see on the last line here:</p>
<pre><code>$ nix build --print-build-logs
# ...
doggo&gt; Executing cargoBuildHook
doggo&gt; ++ env CC_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/cc CXX_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/c++ CC_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/cc CXX_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/c++ cargo build -j 32 --target x86_64-unknown-linux-gnu --frozen --release
</code></pre>
<p>This means when <code>rust-bindgen</code> runs, it doesn't have knowledge about all those paths it <em>probably maybe should</em> have as provided by the <a href="https://github.com/NixOS/nixpkgs/blob/54d0d2b43b5d0b7ee21c30a99012162ecab3f931/pkgs/build-support/cc-wrapper/default.nix#L323-L377"><code>gcc-wrapper</code></a>.</p>
<p>The <code>gcc-wrapper</code> derivation includes several support files in <code>$out/nix-support</code> we can utilize to work around this problem.</p>
<h2 id="additional-paths">Additional paths</h2>
<p>The libraries from <code>gcc-wrapper</code> aren't always enough though. It's common to need additional libraries, such as something like <code>stddef.h</code> which is available in the <code>gcc</code> includes.</p>
<p>In these cases, we can often find the pathes of the relevant libraries by looking at the output from <code>cpp -v /dev/null -o /dev/null</code> (as recommended by the <a href="https://gcc.gnu.org/onlinedocs/cpp/Search-Path.html"><code>gcc</code> docs</a>) in the <code>preBuild</code> phase, and investigating <code>nix build .#doggo --print-build-logs</code>:</p>
<pre><code>rustPlatform.buildRustPackage rec {
  # ...
  preBuild = ''
    cpp -v /dev/null -o /dev/null
  '';
  # ...
}
</code></pre>
<p>That would output a list of paths you could search to find the relevant header:</p>
<pre><code>$ nix build .#doggo --print-build-logs
# ...
doggo&gt; #include &quot;...&quot; search starts here:
doggo&gt; #include &lt;...&gt; search starts here:
doggo&gt;  /nix/store/q8rv03yvqsfipnxwyj0sb6lqs50y5b3q-gcc-10.2.0/lib/gcc/x86_64-unknown-linux-gnu/10.2.0/include
doggo&gt;  /nix/store/q8rv03yvqsfipnxwyj0sb6lqs50y5b3q-gcc-10.2.0/include
doggo&gt;  /nix/store/q8rv03yvqsfipnxwyj0sb6lqs50y5b3q-gcc-10.2.0/lib/gcc/x86_64-unknown-linux-gnu/10.2.0/include-fixed
doggo&gt;  /nix/store/vr4977307zkjprfkivi4lgbzlvig3y9j-glibc-2.32-40-dev/include
doggo&gt; End of search list.
</code></pre>
<p>Once you've found the path, you can 'nixify' it into something like this:</p>
<pre><code># This:
/nix/store/q8rv03yvqsfipnxwyj0sb6lqs50y5b3q-gcc-10.2.0/lib/gcc/x86_64-unknown-linux-gnu/10.2.0/include
# Into:
${stdenv.cc.cc}/lib/gcc/${stdenv.hostPlatform.config}/${lib.getVersion stdenv.cc.cc}/include
</code></pre>
<p>You'll be able to add that path in later.</p>
<h1 id="what-to-do-about-it">What to do about it</h1>
<p>While chatting with the clever <a href="https://jaredweakly.com/">Jared Weakly</a> we noticed that we could tell <code>rust-bindgen</code> about these <code>CFLAGS</code> via <a href="https://github.com/rust-lang/rust-bindgen#environment-variables"><code>BINDGEN_EXTRA_CLANG_ARGS</code></a></p>
<p>What we gleaned from the <a href="https://github.com/NixOS/nixpkgs/blob/master/pkgs/applications/networking/browsers/firefox/common.nix#L247-L253"><code>firefox</code></a> was to add something like this to the <code>preBuild</code>:</p>
<pre><code>rustPlatform.buildRustPackage rec {
  preBuild = ''
    # From: https://github.com/NixOS/nixpkgs/blob/1fab95f5190d087e66a3502481e34e15d62090aa/pkgs/applications/networking/browsers/firefox/common.nix#L247-L253
    # Set C flags for Rust's bindgen program. Unlike ordinary C
    # compilation, bindgen does not invoke $CC directly. Instead it
    # uses LLVM's libclang. To make sure all necessary flags are
    # included we need to look in a few places.
    export BINDGEN_EXTRA_CLANG_ARGS=&quot;$(&lt; ${stdenv.cc}/nix-support/libc-crt1-cflags) \
      $(&lt; ${stdenv.cc}/nix-support/libc-cflags) \
      $(&lt; ${stdenv.cc}/nix-support/cc-cflags) \
      $(&lt; ${stdenv.cc}/nix-support/libcxx-cxxflags) \
      ${lib.optionalString stdenv.cc.isClang &quot;-idirafter ${stdenv.cc.cc}/lib/clang/${lib.getVersion stdenv.cc.cc}/include&quot;} \
      ${lib.optionalString stdenv.cc.isGNU &quot;-isystem ${stdenv.cc.cc}/include/c++/${lib.getVersion stdenv.cc.cc} -isystem ${stdenv.cc.cc}/include/c++/${lib.getVersion stdenv.cc.cc}/${stdenv.hostPlatform.config}&quot;}
    &quot;
  '';
}
</code></pre>
<p>For my additional path (<code>stddef.h</code> from <code>${stdenv.cc.cc}/lib/gcc/${stdenv.hostPlatform.config}/${lib.getVersion stdenv.cc.cc}/include</code>) I changed the last line of the export to include it with an <code>-idirafter</code> flag:</p>
<pre><code># ...
${lib.optionalString stdenv.cc.isGNU &quot;-isystem ${stdenv.cc.cc}/include/c++/${lib.getVersion stdenv.cc.cc} -isystem ${stdenv.cc.cc}/include/c++/${lib.getVersion stdenv.cc.cc}/${stdenv.hostPlatform.config} -idirafter ${stdenv.cc.cc}/lib/gcc/${stdenv.hostPlatform.config}/${lib.getVersion stdenv.cc.cc}/include&quot;}
# ...
</code></pre>
<h1 id="worked-example">Worked Example</h1>
<p>Let's work this example to make sure it's true!</p>
<h2 id="files">Files</h2>
<p>Create some files in a scratch directory:</p>
<pre><code># flake.nix
{
  description = &quot;A bindgen demo.&quot;;

  inputs = {
    nixpkgs.url = &quot;github:NixOS/nixpkgs/nixpkgs-unstable&quot;;
  };

  outputs = { self, nixpkgs }:
    let
      supportedSystems = [ &quot;x86_64-linux&quot; &quot;aarch64-linux&quot; ];
      forAllSystems = f: nixpkgs.lib.genAttrs supportedSystems (system: f system);
    in
    {
      defaultPackage = forAllSystems (system: (import nixpkgs {
        inherit system;
        overlays = [ self.overlay ];
      }).doggo);

      overlay = final: prev: {
        doggo = final.callPackage ./. { };
      };
    };
}
</code></pre>
<pre><code># default.nix
{ lib
, rustPlatform
, stdenv
, hostPlatform
, llvmPackages
}:

let
    cargoToml = (builtins.fromTOML (builtins.readFile ./Cargo.toml));
in
rustPlatform.buildRustPackage rec {
  pname = cargoToml.package.name;
  version = cargoToml.package.version;

  src = ./.;

  #cargoSha256 = lib.fakeSha256;
  cargoSha256 = &quot;k7SDJdjHa5oqgi173aRZcLbBsQcc7ohJqiK7zY2HMP8=&quot;;

  LIBCLANG_PATH = &quot;${llvmPackages.libclang}/lib&quot;;
  doCheck = false;

  preBuild = ''
    # From: https://github.com/NixOS/nixpkgs/blob/1fab95f5190d087e66a3502481e34e15d62090aa/pkgs/applications/networking/browsers/firefox/common.nix#L247-L253
    # Set C flags for Rust's bindgen program. Unlike ordinary C
    # compilation, bindgen does not invoke $CC directly. Instead it
    # uses LLVM's libclang. To make sure all necessary flags are
    # included we need to look in a few places.
    export BINDGEN_EXTRA_CLANG_ARGS=&quot;$(&lt; ${stdenv.cc}/nix-support/libc-crt1-cflags) \
      $(&lt; ${stdenv.cc}/nix-support/libc-cflags) \
      $(&lt; ${stdenv.cc}/nix-support/cc-cflags) \
      $(&lt; ${stdenv.cc}/nix-support/libcxx-cxxflags) \
      ${lib.optionalString stdenv.cc.isClang &quot;-idirafter ${stdenv.cc.cc}/lib/clang/${lib.getVersion stdenv.cc.cc}/include&quot;} \
      ${lib.optionalString stdenv.cc.isGNU &quot;-isystem ${stdenv.cc.cc}/include/c++/${lib.getVersion stdenv.cc.cc} -isystem ${stdenv.cc.cc}/include/c++/${lib.getVersion stdenv.cc.cc}/${stdenv.hostPlatform.config} -idirafter ${stdenv.cc.cc}/lib/gcc/${stdenv.hostPlatform.config}/${lib.getVersion stdenv.cc.cc}/include&quot;} \
    &quot;
  '';

  meta = with lib; {
    description = cargoToml.package.description;
    homepage = cargoToml.package.homepage;
    license = with licenses; [ mit ];
    maintainers = with maintainers; [ hoverbear ];
  };
}
</code></pre>
<pre><code>// wrapper.h
#include &quot;doggo.h&quot;
#include &lt;stdio.h&gt;
</code></pre>
<pre><code>// doggo.h
typedef struct Doggo {
    int breed;
} Doggo;
</code></pre>
<pre><code># Cargo.toml
[package]
name = &quot;doggo&quot;
description = &quot;A demo.&quot;
homepage = &quot;hoverbear.org&quot;
version = &quot;0.1.0&quot;
authors = [&quot;Ana Hobden &lt;operator@hoverbear.org&gt;&quot;]
edition = &quot;2018&quot;

[dependencies]

[build-dependencies]
bindgen = &quot;0.53.1&quot;
</code></pre>
<pre><code>// src/main.rs
include!(concat!(env!(&quot;OUT_DIR&quot;), &quot;/bindings.rs&quot;));

fn main() {
    println!(&quot;Hello, world {:?}!&quot;, Doggo {
        breed: 1,
    });
}
</code></pre>
<pre><code>// build.rs
extern crate bindgen;

use std::env;
use std::path::PathBuf;

fn main() {
    println!(&quot;cargo:rerun-if-changed=wrapper.h&quot;);
    let bindings = bindgen::Builder::default()
        .header(&quot;wrapper.h&quot;)
        .parse_callbacks(Box::new(bindgen::CargoCallbacks))
        .generate()
        .expect(&quot;Unable to generate bindings&quot;);
    let out_path = PathBuf::from(env::var(&quot;OUT_DIR&quot;).unwrap());
    bindings
        .write_to_file(out_path.join(&quot;bindings.rs&quot;))
        .expect(&quot;Couldn't write bindings!&quot;);
}
</code></pre>
<h2 id="working-output">Working output</h2>
<p>Running <code>nix build --print-build-logs</code> should output something like:</p>
<pre><code>$ nix build --print-build-logs --rebuild
warning: Git tree '/home/ana/scratch' is dirty
doggo&gt; unpacking sources
doggo&gt; unpacking source archive /nix/store/xwxksd08px6pmhxwq0wh09hsva51smf7-4bcjjs5zg4mxzhs9qrcz2rjf8ck5wvp1-source
doggo&gt; source root is 4bcjjs5zg4mxzhs9qrcz2rjf8ck5wvp1-source
doggo&gt; Executing cargoSetupPostUnpackHook
doggo&gt; unpacking source archive /nix/store/isna8kr86v18plg2ln91i6n85pm2v7cw-doggo-0.1.0-vendor.tar.gz
doggo&gt; Finished cargoSetupPostUnpackHook
doggo&gt; patching sources
doggo&gt; Executing cargoSetupPostPatchHook
doggo&gt; Validating consistency between /build/4bcjjs5zg4mxzhs9qrcz2rjf8ck5wvp1-source//Cargo.lock and /build/doggo-0.1.0-vendor.tar.gz/Cargo.lock
doggo&gt; Finished cargoSetupPostPatchHook
doggo&gt; configuring
doggo&gt; building
doggo&gt; Executing cargoBuildHook
doggo&gt; ++ env CC_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/cc CXX_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/c++ CC_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/cc CXX_x86_64-unknown-linux-gnu=/nix/store/zzvq5qwlm2xikawfqxb0q8gl2bw391a9-gcc-wrapper-10.2.0/bin/c++ cargo build -j 32 --target x86_64-unknown-linux-gnu --frozen --release
# ...
doggo&gt;     Finished release [optimized] target(s) in 9.44s
doggo&gt; Executing cargoInstallPostBuildHook
doggo&gt; Finished cargoInstallPostBuildHook
doggo&gt; Finished cargoBuildHook
doggo&gt; installing
doggo&gt; Executing cargoInstallHook
doggo&gt; Finished cargoInstallHook
doggo&gt; post-installation fixup
doggo&gt; shrinking RPATHs of ELF executables and libraries in /nix/store/yl3z0gaw618wmzxzn57hyx578lfi3sqz-doggo-0.1.0
doggo&gt; shrinking /nix/store/yl3z0gaw618wmzxzn57hyx578lfi3sqz-doggo-0.1.0/bin/doggo
doggo&gt; strip is /nix/store/5xyjd2qiily84lcv2w2grmwsb8r1hqpr-binutils-2.35.1/bin/strip
doggo&gt; stripping (with command strip and flags -S) in /nix/store/yl3z0gaw618wmzxzn57hyx578lfi3sqz-doggo-0.1.0/bin
doggo&gt; patching script interpreter paths in /nix/store/yl3z0gaw618wmzxzn57hyx578lfi3sqz-doggo-0.1.0
doggo&gt; checking for references to /build/ in /nix/store/yl3z0gaw618wmzxzn57hyx578lfi3sqz-doggo-0.1.0..
</code></pre>
<h2 id="reproducing-the-issue">Reproducing the issue</h2>
<p>To reproduce the issue, try removing the <code>preBuild</code> step from the <code>default.nix</code> you created:</p>
<pre><code>doggo&gt;    Compiling doggo v0.1.0 (/build/kihmwg0msazwl8x84yahp73k1jn816d9-source)
doggo&gt; error: failed to run custom build command for `doggo v0.1.0 (/build/kihmwg0msazwl8x84yahp73k1jn816d9-source)`
doggo&gt; Caused by:
doggo&gt;   process didn't exit successfully: `/build/kihmwg0msazwl8x84yahp73k1jn816d9-source/target/release/build/doggo-12463103eef102f1/build-script-build` (exit code: 101)
doggo&gt;   --- stdout
doggo&gt;   cargo:rerun-if-changed=wrapper.h
doggo&gt;   --- stderr
doggo&gt;   wrapper.h:2:10: fatal error: 'stdio.h' file not found
doggo&gt;   wrapper.h:2:10: fatal error: 'stdio.h' file not found, err: true
doggo&gt;   thread 'main' panicked at 'Unable to generate bindings: ()', build.rs:12:10
doggo&gt;   note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: builder for '/nix/store/kb7rc2hv289gbd9blfviiirzmcra7cm3-doggo-0.1.0.drv' failed with exit code 101;
       last 10 log lines:
       &gt; Caused by:
       &gt;   process didn't exit successfully: `/build/kihmwg0msazwl8x84yahp73k1jn816d9-source/target/release/build/doggo-12463103eef102f1/build-script-build` (exit code: 101)
       &gt;   --- stdout
       &gt;   cargo:rerun-if-changed=wrapper.h
       &gt;
       &gt;   --- stderr
       &gt;   wrapper.h:2:10: fatal error: 'stdio.h' file not found
       &gt;   wrapper.h:2:10: fatal error: 'stdio.h' file not found, err: true
       &gt;   thread 'main' panicked at 'Unable to generate bindings: ()', build.rs:12:10
       &gt;   note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
       For full logs, run 'nix log /nix/store/kb7rc2hv289gbd9blfviiirzmcra7cm3-doggo-0.1.0.drv'.
</code></pre>
<p>If you try removing <code>#include &lt;stdio.h&gt;</code> from the <code>wrapper.h</code> this error will be resolved, but your program will likely want <code>stdio.h</code>.</p>
<p>Whew! That's it! Writing about this really helped me sort it out in my head better! Thanks for reading!</p>

    </main>
    <footer class="post-footer">
    Connect through &nbsp<a href="mailto:operator@hoverbear.org">operator@hoverbear.org</a>,&nbsp;<a href="https://github.com/hoverbear">@hoverbear</a> on Github,&nbsp;<a href="https://twitter.com/a_hoverbear">@a_hoverbear</a> on Twitter,</a>&nbsp;
    or track via <a class="subscribe" href="https:&#x2F;&#x2F;hoverbear.org/rss.xml">RSS Feed</a>.
</footer>
<pre class="artifact"><a id="commit" href="https://github.com/Hoverbear/hoverbear.org/commit/da034546dcea5f4d6d55dd32b6410d8a8e93e7ef
">da034546dcea5f4d6d55dd32b6410d8a8e93e7ef
</a></pre>
    </body>

</html>
